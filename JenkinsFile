pipeline {
    agent any
    stages {
        stage('Build test code') {
            steps {
                bat 'mvn clean install -DskipTests'
            }
        }
        stage('Execute test') {
            steps {
                bat 'mvn test'
            }
        }
    }
    // Archive the built artifacts
       archive (includes: 'pkg/*.gem')

       // publish html
       // snippet generator doesn't include "target:"
       // https://issues.jenkins-ci.org/browse/JENKINS-29711.
       publishHTML (target: [
           allowMissing: false,
           alwaysLinkToLastBuild: false,
           keepAll: true,
           reportDir: 'coverage',
           reportFiles: 'index.html',
           reportName: "RCov Report"
         ])

}
